<html lang="en">
<head>
  <meta http-equiv="content-type" content="text/html; charset=UTF-8">
  <meta charset="utf-8">
  <meta name="generator" content="pandoc" />

    <meta name="author" content="Sahil Seth" />
  
  
  <title>flowr</title>

    <script src="assets/jquery-1.11.0/jquery.min.js"></script>
  <link href="assets/bootstrap-3.3.2/css/bootstrap.min.css" rel="stylesheet" />
  <script src="assets/bootstrap-3.3.2/js/bootstrap.min.js"></script>
  <script src="assets/bootstrap-3.3.2/shim/html5shiv.min.js"></script>
  <script src="assets/bootstrap-3.3.2/shim/respond.min.js"></script>
  <link href="assets/highlight-8.4/tomorrow.css" rel="stylesheet" />
  <script src="assets/highlight-8.4/highlight.pack.js"></script>
  <link href="assets/fontawesome-4.3.0/css/font-awesome.min.css" rel="stylesheet" />
  <script src="assets/stickykit-1.1.1/sticky-kit.min.js"></script>
  <script src="assets/jqueryeasing-1.3/jquery.easing.min.js"></script>
  <link href="assets/packagedocs-0.0.1/pd.css" rel="stylesheet" />
  <script src="assets/packagedocs-0.0.1/pd.js"></script>
  <script src="assets/packagedocs-0.0.1/pd-sticky-toc.js"></script>
  
  
  
    <style type="text/css">
  .section h1 {
    margin-top: 50px;
    margin-bottom: 70px;
    text-align: center;
    border-bottom: 0px;
    font-size: 35px;
    font-weight: 400;
    font-family: "PT Mono","Georgia",Arial,sans-serif;
  }

  .section h2 {
    margin-left: -10px !important;
    border-bottom: 3px solid #5d9fea;
  }

  </style>
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
</head>

<body>

  
  <header class="navbar navbar-white navbar-fixed-top" role="banner" id="header">
    <div class="container">
      <div class="navbar-header">
        <button class="navbar-toggle" type="button" data-toggle="collapse" data-target=".navbar-collapse">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
                <a href="index.html" class="navbar-brand page-scroll">
        flowr - Streamlining Workflows
        </a>
      </div>
            <nav class="collapse navbar-collapse" role="navigation">
        <ul class="nav nav-pills pull-right">
<li>
<a href='docs.html'>Docs</a>
</li>
<li>
<a href='Tutorial.html'>Tutorial</a>
</li>
<li class="active">
<a href='rd.html'>Package Ref</a>
</li>
<li>
<a href='news.html'>News</a>
</li>
<li>
<a href='https://github.com/sahilseth/flowr'>Github <i class='fa fa-github'></i></a>
</li>
        </ul>
      </nav>
          </div>
  </header>

  <!-- Begin Body -->
  <div class="container">
    <div class="row">
            <div class="col-md-3" id="sidebar-col">
        <div id="toc">
          <ul>
          <li><a href="#creating-a-flow">Creating a Flow</a></li>
          <li><a href="#submiting-and-managing-a-flow">Submiting and managing a flow</a></li>
          <li><a href="#managing-parameters">Managing parameters</a></li>
          <li><a href="#details-on-flowrs-classes">Details on flowr’s classes</a></li>
          <li><a href="#other-helpful-functions">Other helpful functions</a></li>
          </ul>
        </div>
      </div>
      <div class="col-md-9" id="content-col">
      
<div id="content-top"></div>
<h1>
Streamlining Design and Deployment of Complex Workflows
</h1>
<p>
<strong>Authors:</strong> <a href="mailto:me@sahilseth.com">Sahil Seth</a> [aut, cre]
</p>
<p>
<strong>Version:</strong> 0.9.7.9021
</p>
<p>
<strong>License:</strong> MIT + file LICENSE
</p>
<h4>
Description
</h4>
<p>
An interface to streamline design of complex workflows and their deployment to a High Performance Computing Cluster.
</p>
<h4>
Depends
</h4>
<p>
methods, params (&gt;= 0.2.8), utils
</p>
<h4>
Imports
</h4>
<p>
diagram, whisker, tools, knitr
</p>
<h4>
Suggests
</h4>
<p>
reshape2, ggplot2, openxlsx, testthat
</p>
<h4>
Enhances
</h4>
<p>
(none)
</p>
<div id="creating-a-flow" class="section level1">
<h1>Creating a Flow</h1>
<<<<<<< Updated upstream
</div>
<div id="submiting-and-managing-a-flow" class="section level1">
<h1>Submiting and managing a flow</h1>
</div>
<div id="managing-parameters" class="section level1">
<h1>Managing parameters</h1>
=======
<div id="to_flowmat" class="section level2">
<h2>to_flowmat</h2>
<h3>
Taking in a named list and returns a two columns data.frame
</h3>
<p class="rd-p">
Taking in a named list and returns a two columns data.frame as.flowmat(): reads a file and checks for required columns. If x is data.frame checks for required columns.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>to_flowmat(x, ...)</div>
<div>## method for class 'list'
to_flowmat(x, samplename, ...)</div>
<div>## method for class 'data.frame'
to_flowmat(x, ...)</div>
<div>## method for class 'flow'
to_flowmat(x, ...)</div>
<div>as.flowmat(x, grp_col, jobname_col, cmd_col, ...)</div>
<div>is.flowmat(x)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
a named list OR vector. Where name corresponds to the jobname and value is a vector of commands to run
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
not used
</dd>
<dt>
samplename
</dt>
<dd class="rd-dd">
character of length 1 or that of nrow(x)
</dd>
<dt>
grp_col
</dt>
<dd class="rd-dd">
column used for grouping, default samplename.
</dd>
<dt>
jobname_col
</dt>
<dd class="rd-dd">
column specifying jobname, default jobname
</dd>
<dt>
cmd_col
</dt>
<dd class="rd-dd">
column specifying commands to run, default cmd
</dd>
</dl>
</div>
<div id="flow_definition" class="section level2">
<h2>flow_definition</h2>
<h3>
Flow Definition defines how to stich pieces of the (work)flow into a flow.
</h3>
<p class="rd-p">
This function enables creation of a skeleton flow definition with several default values, using a flowmat. To customize the flowdef, one may supply parameters such as sub_type and dep_type upfront. As such, these params must be of the same length as number of unique jobs using in the flowmat. Each row in this table refers to one step of the pipeline. It describes the resources used by the step and also its relationship with other steps, especially, the step immediately prior to it. <br><br> <strong>Submission types:</strong> <em>This refers to the sub_type column in flow definition.</em><br> Consider an example with three steps A, B and C. A has 10 commands from A1 to A10, similarly B has 10 commands B1 through B10 and C has a single command, C1. Consider another step D (with D1-D3), which comes after C. A —-&gt; B —–&gt; C —–&gt; D
<ul>
<li>
<code>scatter</code>: submit all commands as parallel, independent jobs. <em>Submit A1 through A10 as independent jobs</em>
</li>
<li>
<code>serial</code>: run these commands sequentially one after the other. - <em>Wrap A1 through A10, into a single job.</em>
</li>
</ul>
<strong>Dependency types</strong> <em>This refers to the dep_type column in flow definition.</em>
<ul>
<li>
<code>none</code>: independent job.
<ul>
</ul>
</li>
<li>
<code>serial</code>: <em>one to one</em> relationship with previous job.
<ul>
</ul>
</li>
<li>
<code>gather</code>: <em>many to one</em>, wait for <strong>all</strong> commands in previous job to finish then start the current step.
<ul>
</ul>
</li>
<li>
<code>burst</code>: <em>one to many</em> wait for the previous step which has one job and start processing all cmds in the current step. - <em>D1 to D3 are started as soon as C1 finishes.</em>
</li>
</ul>
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>to_flowdef(x, ...)</div>
<div>## method for class 'flowmat'
to_flowdef(x, sub_type, dep_type, prev_jobs, queue&nbsp;=&nbsp;"short", platform&nbsp;=&nbsp;"torque", memory_reserved&nbsp;=&nbsp;"2000", cpu_reserved&nbsp;=&nbsp;"1", walltime&nbsp;=&nbsp;"1:00", verbose&nbsp;=&nbsp;get_opts("verbose"), ...)</div>
<div>## method for class 'flow'
to_flowdef(x, ...)</div>
<div>## method for class 'character'
to_flowdef(x, ...)</div>
<div>as.flowdef(x, ...)</div>
<div>is.flowdef(x)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
can a path to a flowmat, flomat or flow object.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
not used
</dd>
<dt>
sub_type
</dt>
<dd class="rd-dd">
submission type, one of: scatter, serial. Character, of length one or same as the number of jobnames
</dd>
<dt>
dep_type
</dt>
<dd class="rd-dd">
dependency type, one of: gather, serial or burst. Character, of length one or same as the number of jobnames
</dd>
<dt>
prev_jobs
</dt>
<dd class="rd-dd">
previous job name
</dd>
<dt>
queue
</dt>
<dd class="rd-dd">
Cluster queue to be used
</dd>
<dt>
platform
</dt>
<dd class="rd-dd">
platform of the cluster: lsf, sge, moab, torque, slurm etc.
</dd>
<dt>
memory_reserved
</dt>
<dd class="rd-dd">
amount of memory required.
</dd>
<dt>
cpu_reserved
</dt>
<dd class="rd-dd">
number of cpus required
</dd>
<dt>
walltime
</dt>
<dd class="rd-dd">
amount of walltime required
</dd>
<dt>
verbose
</dt>
<dd class="rd-dd">
A numeric value indicating the amount of messages to produce. Values are integers varying from 0, 1, 2, 3, …. Please refer to the <a href=#verbose>verbose</a> page for more details. [<code>get_opts(“verbose”)</code>] [1]
</dd>
</dl>
<h4>
Format
</h4>
<p class="rd-p">
This is a tab separated file, with a minimum of 4 columns:<br>
</p>
<p class="rd-p">
<em>required columns</em>:<br>
<ul>
<li>
<code>jobname</code>: Name of the step
</li>
<li>
<code>sub_type</code>: Short for submission type, refers to, how should multiple commands of this step be submitted. Possible values are <code>serial</code> or <code>scatter</code>.
</li>
<li>
<code>prev_jobs</code>: Short for previous job, this would be jobname of the previous job. This can be NA/./none if this is a independent/initial step, and no previous step is required for this to start.
</li>
<li>
<code>dep_type</code>: Short for dependency type, refers to the relationship of this job with the one defined in <code>prev_jobs</code>. This can take values <code>none</code>, <code>gather</code>, <code>serial</code> or <code>burst</code>.
</li>
</ul>
</p>
<p class="rd-p">
<em>resource columns</em> (recommended):<br>
</p>
<p class="rd-p">
Apart from the above described variables, several other variables defining the resource requirements of each step are also available. These give great amount of flexibility to the user in choosing CPU, wall time, memory and queue for each step (and are passed along to the HPCC platform).
<ul>
<li>
<code>cpu_reserved</code>
</li>
<li>
<code>memory_reserved</code>
</li>
<li>
<code>nodes</code>
</li>
<li>
<code>walltime</code>
</li>
<li>
<code>queue</code>
</li>
</ul>
</p>
</div>
<div id="to_flow" class="section level2">
<h2>to_flow</h2>
<h3>
Create flow objects
</h3>
<p class="rd-p">
Use a set of shell commands and flow definiton to create <a href='flow.html'>flow</a> object. vector: a file with flowmat table a named list of commands for a sample. Its best to supply a flowmat instead.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>to_flow(x, ...)</div>
<div>## method for class 'character'
to_flow(x, def, grp_col, jobname_col, cmd_col, ...)</div>
<div>## method for class 'flowmat'
to_flow(x, def, grp_col, jobname_col, cmd_col, flowname, flow_run_path, platform, submit&nbsp;=&nbsp;FALSE, execute&nbsp;=&nbsp;FALSE, qobj, verbose&nbsp;=&nbsp;get_opts("verbose"), ...)</div>
<div>## method for class 'data.frame'
to_flow(x, ...)</div>
<div>## method for class 'list'
to_flow(x, def, flowname, flow_run_path, desc, qobj, verbose&nbsp;=&nbsp;get_opts("verbose"), ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
path (char. vector) to flow_mat, a data.frame or a list.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Supplied to specific functions like <code>to_flow.data.frame</code>
</dd>
<dt>
def
</dt>
<dd class="rd-dd">
A flow definition table. Basically a table with resource requirements and mapping of the jobs in this flow
</dd>
<dt>
grp_col
</dt>
<dd class="rd-dd">
column name used to split x (flow_mat). [samplename]
</dd>
<dt>
jobname_col
</dt>
<dd class="rd-dd">
column name with job names. [jobname]
</dd>
<dt>
cmd_col
</dt>
<dd class="rd-dd">
column name with commands. [cmd]
</dd>
<dt>
flowname
</dt>
<dd class="rd-dd">
name of the flow [flowname]
</dd>
<dt>
flow_run_path
</dt>
<dd class="rd-dd">
Path to a folder. Main operating folder for this flow. [<code>get_opts(“flow_run_path”)</code>][<code>~/flowr/runs</code>].
</dd>
<dt>
platform
</dt>
<dd class="rd-dd">
character vector, specifying the platform to use. local, lsf, torque, moab, sge, slurm, … This over-rides the platform column in flowdef. (optional)
</dd>
<dt>
submit
</dt>
<dd class="rd-dd">
Use submit_flow on flow object this function returns. TRUE/FALSE. [FALSE]
</dd>
<dt>
execute
</dt>
<dd class="rd-dd">
Use submit_flow on flow object this function returns. TRUE/FALSE, an paramter to submit_flow(). [FALSE]
</dd>
<dt>
qobj
</dt>
<dd class="rd-dd">
Depreciated, modify <a href = http://docs.flowr.space/en/latest/rd/vignettes/build-pipes.html#cluster-interface>cluster templates</a> instead. A object of class <a href=#queue>queue</a>.
</dd>
<dt>
verbose
</dt>
<dd class="rd-dd">
A numeric value indicating the amount of messages to produce. Values are integers varying from 0, 1, 2, 3, …. Please refer to the <a href=#verbose>verbose</a> page for more details. [<code>get_opts(“verbose”)</code>] [1]
</dd>
<dt>
desc
</dt>
<dd class="rd-dd">
Advanced Use. final flow name, please dont change.
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
The parameter x can be a path to a flow_mat, or a data.frame (as read by read_sheet). This is a minimum three column matrix with three columns: samplename, jobname and cmd
</p>
<h4>
Value
</h4>
<p class="rd-p">
<dl>
Returns a flow object. If execute=TRUE, fobj is rich with information about where and how the flow was executed. It would include details like jobids, path to exact scripts run etc. To use kill_flow, to kill all the jobs one would need a rich flow object, with job ids present.
</p>
<p class="rd-p">
<strong>Behaviour:</strong> What goes in, and what to expect in return?
<ul>
<li>
submit=FALSE &amp; execute=FALSE: Create and return a flow object
</li>
<li>
submit=TRUE &amp; execute=FALSE: dry-run, Create a flow object then, create a structured execution folder with all the commands
</li>
<li>
submit=TRUE, execute=TRUE: Do all of the above and then, submit to cluster
</li>
</ul>
</p>
<p class="rd-p">
</dl>
</p>
<h4>
Examples
</h4>
<pre class="r"><code>ex = file.path(system.file(package = "flowr"), "pipelines")
flowmat = as.flowmat(file.path(ex, "sleep_pipe.tsv"))
flowdef = as.flowdef(file.path(ex, "sleep_pipe.def"))
fobj = to_flow(x = flowmat, def = flowdef, flowname = "sleep_pipe", platform = "lsf")</code></pre>
</div>
</div>
<div id="submiting-and-managing-a-flow" class="section level1">
<h1>Submiting and managing a flow</h1>
<div id="submit_flow" class="section level2">
<h2>submit_flow</h2>
<h3>
submit_flow
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>submit_flow(x, verbose&nbsp;=&nbsp;get_opts("verbose"), ...)</div>
<div>## method for class 'list'
submit_flow(x, verbose&nbsp;=&nbsp;get_opts("verbose"), ...)</div>
<div>## method for class 'flow'
submit_flow(x, verbose&nbsp;=&nbsp;get_opts("verbose"), execute&nbsp;=&nbsp;FALSE, uuid, plot&nbsp;=&nbsp;TRUE, dump&nbsp;=&nbsp;TRUE, .start_jid&nbsp;=&nbsp;1, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
a <code>object</code> of class <code>flow</code>.
</dd>
<dt>
verbose
</dt>
<dd class="rd-dd">
logical.
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
Advanced use. Any additional parameters are passed on to <a href=#submit_job>submit_job</a> function.
</dd>
<dt>
execute
</dt>
<dd class="rd-dd">
<code>logical</code> whether or not to submit the jobs
</dd>
<dt>
uuid
</dt>
<dd class="rd-dd">
<code>character</code> Advanced use. This is the final path used for flow execution. Especially useful in case of re-running a flow.
</dd>
<dt>
plot
</dt>
<dd class="rd-dd">
<code>logical</code> whether to make a pdf flow plot (saves it in the flow working directory).
</dd>
<dt>
dump
</dt>
<dd class="rd-dd">
dump all the flow details to the flow path
</dd>
<dt>
.start_jid
</dt>
<dd class="rd-dd">
Job to start this submission from. Advanced use, should be 1 by default.
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>submit_flow(fobj = fobj, ... = ...)</code></pre>
</div>
<div id="plot_flow" class="section level2">
<h2>plot_flow</h2>
<h3>
plot_flow
</h3>
<p class="rd-p">
plot the flow object plot_flow.character: works on a flowdef file.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>plot_flow(x, ...)</div>
<div>## method for class 'flow'
plot_flow(x, ...)</div>
<div>## method for class 'list'
plot_flow(x, ...)</div>
<div>## method for class 'character'
plot_flow(x, ...)</div>
<div>## method for class 'flowdef'
plot_flow(x, detailed&nbsp;=&nbsp;TRUE, type&nbsp;=&nbsp;c("1", "2"), pdf&nbsp;=&nbsp;FALSE, pdffile, ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
Object of class <code>flow</code>, or a list of flow objects or a flowdef
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
experimental
</dd>
<dt>
detailed
</dt>
<dd class="rd-dd">
include some details
</dd>
<dt>
type
</dt>
<dd class="rd-dd">
1 is original, and 2 is a elipse with less details
</dd>
<dt>
pdf
</dt>
<dd class="rd-dd">
create a pdf instead of plotting interactively
</dd>
<dt>
pdffile
</dt>
<dd class="rd-dd">
output file name for the pdf file
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>qobj = queue(type="lsf")
cmds = rep("sleep 5", 10)
jobj1 <- job(q_obj=qobj, cmd = cmds, submission_type = "scatter", name = "job1")
jobj2 <- job(q_obj=qobj, name = "job2", cmd = cmds, submission_type = "scatter",
             dependency_type = "serial", previous_job = "job1")
fobj <- flow(jobs = list(jobj1, jobj2))
plot_flow(fobj)

### Gather: many to one relationship
jobj1 <- job(q_obj=qobj, cmd = cmds, submission_type = "scatter", name = "job1")
jobj2 <- job(q_obj=qobj, name = "job2", cmd = cmds, submission_type = "scatter",
             dependency_type = "gather", previous_job = "job1")
fobj <- flow(jobs = list(jobj1, jobj2))
plot_flow(fobj)

### Burst: one to many relationship
jobj1 <- job(q_obj=qobj, cmd = cmds, submission_type = "serial", name = "job1")
jobj2 <- job(q_obj=qobj, name = "job2", cmd = cmds, submission_type = "scatter",
             dependency_type = "burst", previous_job = "job1")
fobj <- flow(jobs = list(jobj1, jobj2))
plot_flow(fobj)</code></pre>
</div>
<div id="status" class="section level2">
<h2>status</h2>
<h3>
status
</h3>
<p class="rd-p">
Summarize status of executed flow(x)
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>status(x, out_format&nbsp;=&nbsp;"markdown")</div>
<div>get_status(x, ...)</div>
<div>## method for class 'character'
get_status(x, out_format&nbsp;=&nbsp;"markdown", ...)</div>
<div>## method for class 'data.frame'
get_status(x, ...)</div>
<div>## method for class 'flow'
get_status(x, out_format&nbsp;=&nbsp;"markdown", ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
path to the flow root folder or a parent folder to summarize several flows.
</dd>
<dt>
out_format
</dt>
<dd class="rd-dd">
passed onto knitr:::kable. supports: markdown, rst, html…
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
not used
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
basename(x) is used in a wild card search.
</p>
<p class="rd-p">
<ul>
<li>
If x is a path with a single flow, it outputs the status of one flow.
</li>
<li>
If the path has more than one flow then this could give a summary of <strong>all</strong> of them.
</li>
<li>
Instead if x is supplied with paths to more than one flow, then this individually prints status of each.
</li>
</ul>
</p>
<p class="rd-p">
Alternatively, x can also be a flow object
</p>
<h4>
Examples
</h4>
<pre class="r"><code>status(x = "~/flowr/runs/sleep_pipe*")
## an example for running from terminal
flowr status x=path_to_flow_directory cores=6</code></pre>
</div>
<div id="kill" class="section level2">
<h2>kill</h2>
<h3>
Kill all jobs submitted to the computing platform, for one or multiple flows
</h3>
<p class="rd-p">
<strong>A pipeline requires files which are created at the end of the submit_flow command</strong>. Even if you want to kill the flow, its best to let submit_flow do its job, when done simply use kill(flow_wd). If submit_flow is interrupted, flow_details etc files are not created, thus flowr looses the association of jobs with flow instance.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>kill(x, ...)</div>
<div>## method for class 'character'
kill(x, force&nbsp;=&nbsp;FALSE, ...)</div>
<div>## method for class 'flow'
kill(x, kill_cmd, verbose&nbsp;=&nbsp;get_opts("verbose"), jobid_col&nbsp;=&nbsp;"job_sub_id", ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
either path to flow wd or object of class <a href=#flow>flow</a>
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
not used
</dd>
<dt>
force
</dt>
<dd class="rd-dd">
You need to set force=TRUE, to kill multiple flows. This makes sure multiple flows are NOT killed by accident.
</dd>
<dt>
kill_cmd
</dt>
<dd class="rd-dd">
The command used to kill. flowr tries to guess this commands, as defined in the detect_kill_cmd(). Supplying it here; fot custom platoforms.
</dd>
<dt>
verbose
</dt>
<dd class="rd-dd">
A numeric value indicating the amount of messages to produce. Values are integers varying from 0, 1, 2, 3, …. Please refer to the <a href=#verbose>verbose</a> page for more details. [<code>get_opts(“verbose”)</code>] [1]
</dd>
<dt>
jobid_col
</dt>
<dd class="rd-dd">
Advanced use. The column name in flow_details.txt file used to fetch jobids to kill
</dd>
</dl>
<h4>
Examples
</h4>
<pre class="r"><code>## example for terminal
## flowr kill_flow x=path_to_flow_directory
## In case path matches multiple folders, flowr asks before killing
kill(x='fastq_haplotyper*')
 Flowr: streamlining workflows
 found multiple wds:
 /fastq_haplotyper-MS132-20150825-16-24-04-0Lv1PbpI
 /fastq_haplotyper-MS132-20150825-17-47-52-5vFIkrMD
 Really kill all of them ? kill again with force=TRUE

## submitting again with force=TRUE will kill them:
kill(x='fastq_haplotyper*', force = TRUE)</code></pre>
</div>
<div id="rerun" class="section level2">
<h2>rerun</h2>
<h3>
Re-run a pipeline in case of hardware or software failures.
</h3>
<p class="rd-p">
<ul>
<li>
<strong>hardware</strong> no change required, simple rerun: <code>rerun(x=flow_wd)</code>
</li>
<li>
<strong>software</strong> either a change to flowmat or flowdef has been made: <code>rerun(x=flow_wd, mat = new_flowmat, def = new_flowdef)</code>
</li>
</ul>
<strong>NOTE:</strong> <em>flow_wd</em>: flow working directory, same input as used for <a href='status.html'>status</a>
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>rerun(x, ...)</div>
<div>## method for class 'character'
rerun(x, ...)</div>
<div>## method for class 'flow'
rerun(x, mat, def, start_from, execute&nbsp;=&nbsp;TRUE, kill&nbsp;=&nbsp;TRUE, select, ignore, verbose&nbsp;=&nbsp;get_opts("verbose"), ...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
x
</dt>
<dd class="rd-dd">
flow working directory
</dd>
<dt>
…
</dt>
<dd class="rd-dd">
passed onto to_flow
</dd>
<dt>
mat
</dt>
<dd class="rd-dd">
(optional) flowmat fetched from previous submission if missing. For more information regarding the format refer to <a href=#to_flowmat>to_flowmat</a>
</dd>
<dt>
def
</dt>
<dd class="rd-dd">
(optional) flowdef fetched from previous submission if missing. For more information regarding the format refer to <a href=#flowdef>to_flowdef</a>
</dd>
<dt>
start_from
</dt>
<dd class="rd-dd">
which job to start from, this is a job name.
</dd>
<dt>
execute
</dt>
<dd class="rd-dd">
[logical] whether to execute or not
</dd>
<dt>
kill
</dt>
<dd class="rd-dd">
(optional) logical indicating whether to kill the jobs from the previous execution of flow.
</dd>
<dt>
select
</dt>
<dd class="rd-dd">
select a subset of jobs to rerun [character vector]
</dd>
<dt>
ignore
</dt>
<dd class="rd-dd">
ignore a subset of jobs to rerun [character vector]
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
This function fetches details regarding the previous execution from the flow working directory (flow_wd).
</p>
<p class="rd-p">
It reads the <a href=#flow>flow</a> object from the flow_details.rds file, and extracts flowdef and flowmat from it using <a href=#to_flowmat>to_flowmat</a> and <a href=#flowdef>to_flowdef</a> functions.
</p>
<p class="rd-p">
<strong>New flowmat / flowdef</strong> for re-run:
</p>
<p class="rd-p">
Optionally, if either of these (flowmat or flowdef) are supplied, supplied ones are used instead for the new submission.
</p>
<p class="rd-p">
This functions efficiently updates job details of the latest submission into the previous file; thus information regarding previous job ids and their status is not lost.
</p>
<h4>
Examples
</h4>
<pre class="r"><code>rerun_flow(wd = wd, fobj = fobj, execute = TRUE, kill = TRUE)</code></pre>
</div>
</div>
<div id="managing-parameters" class="section level1">
<h1>Managing parameters</h1>
<div id="flowopts" class="section level2">
<h2>flowopts</h2>
<h3>
Default options/params used in ngsflows and flowr
</h3>
<p class="rd-p">
There are three helper functions which attempt to manage params used by flowr and ngsflows:
<ul>
<li>
<a href='http://www.inside-r.org/packages/cran/params/docs/params'>get_opts</a> OR <code>opts_flow$get()</code>: show all default options
</li>
<li>
<a href='http://www.inside-r.org/packages/cran/params/docs/params'>set_opts</a> OR <code>opts_flow$set()</code>: set default options
</li>
<li>
<a href='http://www.inside-r.org/packages/cran/params/docs/params'>load_opts</a> OR <code>opts_flow$load()</code>: load options specified in a tab seperated text file
</li>
</ul>
For more details regarding these funtions refer to <a href='http://www.inside-r.org/packages/cran/params/docs/params'>params</a>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>flowopts</div>
<div>get_opts(...)
set_opts(...)
load_opts(...)</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
…
</dt>
<dd class="rd-dd">
<ul>
<li>
get: names of options to fetch
</li>
<li>
set: a set of options in a name=value format seperated by commas
</li>
</ul>
</dd>
</dl>
<h4>
Format
</h4>
<p class="rd-p">
<code>opts_flow</code>
</p>
<h4>
Details
</h4>
<p class="rd-p">
By default flowr loads, <code>~/flowr/conf/flowr.conf</code> and <code>~/flowr/conf/ngsflows.conf</code>
</p>
<p class="rd-p">
Below is a list of default flowr options, retrieved via
</p>
<p class="rd-p">
<code>opts_flow$get()</code>:
<pre>
    |name              |value                    |
    |:-----------------|:------------------------|
    |default_regex     |(.*)                     |
    |flow_base_path    |~/flowr                  |
    |flow_conf_path    |~/flowr/conf             |
    |flow_parse_lsf    |.*(\<[0-9]*\>).*         |
    |flow_parse_moab   |(.*)                     |
    |flow_parse_sge    |(.*)                     |
    |flow_parse_slurm  |(.*)                     |
    |flow_parse_torque |(.?)\..*                 |
    |flow_pipe_paths   |~/flowr/pipelines        |
    |flow_pipe_urls    |~/flowr/pipelines        |
    |flow_platform     |local                    |
    |flow_run_path     |~/flowr/runs             |
    |my_conf_path      |~/flowr/conf             |
    |my_dir            |path/to/a/folder         |
    |my_path           |~/flowr                  |
    |my_tool_exe       |/usr/bin/ls              |
    |time_format       |%a %b %e %H:%M:%S CDT %Y |
    |verbose           |FALSE                    |
    </pre>
</p>
<h4>
Examples
</h4>
<pre class="r"><code>## Set options: set_opts()
opts = set_opts(flow_run_path = "~/mypath")
## OR if you would like to supply a long list of options:
opts = set_opts(.dots = list(flow_run_path = "~/mypath"))

## load options from a configuration file: load_opts()
conffile = fetch_conf("flowr.conf")
load_opts(conffile)

## Fetch options: get_opts()
get_opts("flow_run_path")
get_opts()</code></pre>
</div>
<div id="setup" class="section level2">
<h2>setup</h2>
<h3>
Setup and initialize some scripts.
</h3>
<h4>
Usage
</h4>
<pre class="r"><code><div>setup(bin&nbsp;=&nbsp;"~/bin", flow_base_path&nbsp;=&nbsp;get_opts("flow_base_path"))</div></code></pre>
<h4>
Arguments
</h4>
<dl class="rd-dl">
<dt>
bin
</dt>
<dd class="rd-dd">
path to bin folder
</dd>
<dt>
flow_base_path
</dt>
<dd class="rd-dd">
the root folder for all flowr operations
</dd>
</dl>
<h4>
Details
</h4>
<p class="rd-p">
Will add more to this to identify cluster and aid in other things
</p>
</div>
<div id="verbose" class="section level2">
<h2>verbose</h2>
<h3>
Verbose levels, defining verboseness of messages
</h3>
<p class="rd-p">
There are several levels of verboseness one can choose from. <strong>levels:</strong>
<ul>
<li>
level 0 is almost silent, producing only necessary messages
</li>
<li>
level 1 is good for most purposes, where as,
</li>
<li>
level 2 is good when developing a new pipeline.
</li>
<li>
level 3 is good for debugging, especially when getting un-expected results.
</li>
</ul>
One can set the level of verboseness using <code>opts_flow$set(verbose=2)</code>, which will be used across flowr and ngsflows packages. Additionally one may set this value in the configurations files: <code>~/flowr/conf/flowr.conf</code> OR <code>~/flowr/conf/ngsflows.conf</code>.
</p>
<h4>
Usage
</h4>
<pre class="r"><code><div>verbose</div></code></pre>
<h4>
Format
</h4>
<p class="rd-p">
<pre> NULL
</pre>
</p>
<h4>
Examples
</h4>
<pre class="r"><code>fl = system.file("pipelines/abcd.def", package = "flowr")
def = as.flowdef(fl, verbose = 0)
    # def seems to be a file, reading it...
def = as.flowdef(fl, verbose = 1)
    # def seems to be a file, reading it...
    # checking if required columns are present...
    # checking if resources columns are present...
    # checking if dependency column has valid names...
    # checking if submission column has valid names...
    # checking for missing rows in def...
    # checking for extra rows in def...
    # checking submission and dependency types...
def = as.flowdef(fl, verbose = 2)
    # def seems to be a file, reading it...
    # checking if required columns are present...
    # checking if resources columns are present...
    # checking if dependency column has valid names...
    # checking if submission column has valid names...
    # checking for missing rows in def...
    # checking for extra rows in def...
    # checking submission and dependency types...
    # jobname   prev.sub_type --> dep_type --> sub_type: relationship
    #   1: A    none --> none --> scatter
    #   2: B    scatter --> serial --> scatter rel: complex one:one
    #   3: C    scatter --> gather --> serial rel: many:one
    #   4: D    serial --> burst --> scatter rel: one:many</code></pre>
</div>
>>>>>>> Stashed changes
</div>
<div id="details-on-flowrs-classes" class="section level1">
<h1>Details on flowr’s classes</h1>
</div>
<div id="other-helpful-functions" class="section level1">
<h1>Other helpful functions</h1>
</div>


      </div>
    </div>
  </div>

  <div id="footer">
    <div class="container">
      <div class="col-md-6">
                <p>&copy; Sahil Seth, 2015</p>
              </div>
      <div class="col-md-6">
        <p class="pull-right">created with <a href="https://github.com/hafen/packagedocs">packagedocs</a></p>
      </div>
    </div>
  </div>

  
</body>
</html>
